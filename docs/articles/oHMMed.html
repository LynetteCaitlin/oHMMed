<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • oHMMed</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="oHMMed">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oHMMed</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/oHMMed.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      
      <div class="hidden name"><code>oHMMed.Rmd</code></div>

    </div>

    
    
<p>The <code>oHMMed</code> package contains an implementation of Hidden
Markov Models with ordered hidden states and emission densities. More
precisely: We assume a sequence of un-observable (’hidden’) variables
with discrete categories known as states. Moving along this sequence,
the probability of a specific state occurring at any step depends only
on the state preceding it. Each hidden variable along the sequence
produces/’emits’ an observable data point. We assume that these emitted
data points are distributed according to some continuous distribution
(currently: normal or gamma-poisson compound) with state-specific
parameters. Further, we assume that the continuous emission
distributions per state are parametrised so that they can be ordered by
increasing mean. In fact, transitions between states in the hidden
sequence can only occur between states that emit densities that are
neighbours in the ordering by mean. Given the observed data sequence,
our models assign each part of the hidden sequence to a state, and infer
the transition rates between them as well as the parameters of the
state-specific emission distributions. This is the general framework of
<code>oHMMed</code> (ordered Hidden Markov Model with emission
densities), and it can be applied to any system that fulfils these
assumptions.</p>
<div class="section level2">
<h2 id="normal-model">Normal model<a class="anchor" aria-label="anchor" href="#normal-model"></a>
</h2>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">^</span><span class="fl">10</span>
<span class="va">true_T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.05</span>, <span class="fl">0</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.95</span>, <span class="fl">0.025</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>

<span class="va">true_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>
<span class="va">true_sd</span> <span class="op">&lt;-</span> <span class="fl">1.5</span>

<span class="va">simdata_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm_simulate_normal_data.html">hmm_simulate_normal_data</a></span><span class="op">(</span>L <span class="op">=</span> <span class="va">N</span>,
                                        mat_T <span class="op">=</span> <span class="va">true_T</span>,
                                        means <span class="op">=</span> <span class="va">true_means</span>,
                                        sigma <span class="op">=</span> <span class="va">true_sd</span><span class="op">)</span>
<span class="va">simdata</span> <span class="op">&lt;-</span> <span class="va">simdata_full</span><span class="op">$</span><span class="va">data</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p><img src="oHMMed_files/figure-html/data_normal-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set priors</span>
<span class="va">n_states_inferred</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">prior_T</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_random_T.html">generate_random_T</a></span><span class="op">(</span><span class="va">n_states_inferred</span><span class="op">)</span>
<span class="va">prior_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">18</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span>
<span class="va">prior_sd</span> <span class="op">&lt;-</span> <span class="fl">3</span>

<span class="co"># Run MCMC</span>
<span class="va">res_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm_mcmc_normal.html">hmm_mcmc_normal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simdata</span>,
                              prior_T <span class="op">=</span> <span class="va">prior_T</span>,
                              prior_means <span class="op">=</span> <span class="va">prior_means</span>,
                              prior_sd <span class="op">=</span> <span class="va">prior_sd</span>,
                              iter <span class="op">=</span> <span class="fl">50</span>,
                              print_params <span class="op">=</span> <span class="cn">FALSE</span>,
                              verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## hmm_mcmc_normal(): at least one element in `init_means` is at least 5x bigger than the sample mean.</span></code></pre>
<pre><code><span class="co">## 10%</span></code></pre>
<pre><code><span class="co">## 20%</span></code></pre>
<pre><code><span class="co">## 30%</span></code></pre>
<pre><code><span class="co">## 40%</span></code></pre>
<pre><code><span class="co">## 50%</span></code></pre>
<pre><code><span class="co">## 60%</span></code></pre>
<pre><code><span class="co">## 70%</span></code></pre>
<pre><code><span class="co">## 80%</span></code></pre>
<pre><code><span class="co">## 90%</span></code></pre>
<pre><code><span class="co">## 100%</span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_normal</span></code></pre></div>
<pre><code><span class="co">## Model: HMM Normal </span>
<span class="co">## Type: MCMC </span>
<span class="co">## Iter: 50 </span>
<span class="co">## Warmup: 10 </span>
<span class="co">## Thin: 1 </span>
<span class="co">## States: 3</span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">summary_res_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_normal</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Estimated means:</span>
<span class="co">##   mean[1]   mean[2]   mean[3] </span>
<span class="co">## -4.863729  1.727790  1.918168 </span>
<span class="co">## </span>
<span class="co">## Estimated sd:</span>
<span class="co">## 2.639458</span>
<span class="co">## </span>
<span class="co">## Estimated transition rates:</span>
<span class="co">##            1           2          3</span>
<span class="co">## 1 0.96160629 0.038393714 0.00000000</span>
<span class="co">## 2 0.02589449 0.001118749 0.97298676</span>
<span class="co">## 3 0.00000000 0.914032829 0.08596717</span>
<span class="co">## </span>
<span class="co">## Assigned states:</span>
<span class="co">##   1   2   3 </span>
<span class="co">## 250 347 427 </span>
<span class="co">## </span>
<span class="co">## Approximate Kullback-Leibler divergence:</span>
<span class="co">## 0.011923</span>
<span class="co">## </span>
<span class="co">## Log Likelihood:</span>
<span class="co">##         mean           sd       median </span>
<span class="co">## -2505.737959     1.748131 -2505.356037</span></code></pre>
</div>
<div class="section level3">
<h3 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_normal</span><span class="op">)</span></code></pre></div>
<p><img src="oHMMed_files/figure-html/diagnostics_normal-1.png" width="700"><img src="oHMMed_files/figure-html/diagnostics_normal-2.png" width="700"><img src="oHMMed_files/figure-html/diagnostics_normal-3.png" width="700"><img src="oHMMed_files/figure-html/diagnostics_normal-4.png" width="700"><img src="oHMMed_files/figure-html/diagnostics_normal-5.png" width="700"><img src="oHMMed_files/figure-html/diagnostics_normal-6.png" width="700"><img src="oHMMed_files/figure-html/diagnostics_normal-7.png" width="700"><img src="oHMMed_files/figure-html/diagnostics_normal-8.png" width="700"><img src="oHMMed_files/figure-html/diagnostics_normal-9.png" width="700"><img src="oHMMed_files/figure-html/diagnostics_normal-10.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
