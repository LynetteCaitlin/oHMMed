<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="oHMMed">
<title> • oHMMed</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="oHMMed">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">oHMMed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/oHMMed.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="external-link dropdown-item" href="https://github.com/LynetteCaitlin/oHMMed/blob/main/UsageRecommendations.pdf">Usage Recommendations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/LynetteCaitlin/oHMMed/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LynetteCaitlin/oHMMed/blob/HEAD/vignettes/oHMMed.Rmd" class="external-link"><code>vignettes/oHMMed.Rmd</code></a></small>
      <div class="d-none name"><code>oHMMed.Rmd</code></div>
    </div>

    
    
<p>The <code>oHMMed</code> package contains an implementation of Hidden
Markov Models with ordered hidden states and emission densities. More
precisely: We assume a sequence of un-observable (’hidden’) variables
with discrete categories known as states. Moving along this sequence,
the probability of a specific state occurring at any step depends only
on the state preceding it. Each hidden variable along the sequence
produces/’emits’ an observable data point. We assume that these emitted
data points are distributed according to some continuous distribution
(currently: normal or gamma-poisson compound) with state-specific
parameters. Further, we assume that the continuous emission
distributions per state are parametrised so that they can be ordered by
increasing mean. In fact, transitions between states in the hidden
sequence can only occur between states that emit densities that are
neighbours in the ordering by mean. Given the observed data sequence,
our models assign each part of the hidden sequence to a state, and infer
the transition rates between them as well as the parameters of the
state-specific emission distributions. This is the general framework of
<code>oHMMed</code> (ordered Hidden Markov Model with emission
densities), and it can be applied to any system that fulfils these
assumptions.</p>
<div class="section level2">
<h2 id="normal-model">Normal model<a class="anchor" aria-label="anchor" href="#normal-model"></a>
</h2>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">^</span><span class="fl">10</span>
<span class="va">true_T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.05</span>, <span class="fl">0</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.95</span>, <span class="fl">0.025</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>

<span class="va">true_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>
<span class="va">true_sd</span> <span class="op">&lt;-</span> <span class="fl">1.5</span>

<span class="va">simdata_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm_simulate_normal_data.html">hmm_simulate_normal_data</a></span><span class="op">(</span>L <span class="op">=</span> <span class="va">N</span>,
                                        mat_T <span class="op">=</span> <span class="va">true_T</span>,
                                        means <span class="op">=</span> <span class="va">true_means</span>,
                                        sigma <span class="op">=</span> <span class="va">true_sd</span><span class="op">)</span>
<span class="va">simdata</span> <span class="op">&lt;-</span> <span class="va">simdata_full</span><span class="op">$</span><span class="va">data</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p><img src="vignettesdata_normal-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set priors</span>
<span class="va">n_states_inferred</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">prior_T</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_random_T.html">generate_random_T</a></span><span class="op">(</span><span class="va">n_states_inferred</span><span class="op">)</span>
<span class="va">prior_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span>
<span class="va">prior_sd</span> <span class="op">&lt;-</span> <span class="fl">3</span>

<span class="co"># Run MCMC</span>
<span class="va">res_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm_mcmc_normal.html">hmm_mcmc_normal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simdata</span>,
                              prior_T <span class="op">=</span> <span class="va">prior_T</span>,
                              prior_means <span class="op">=</span> <span class="va">prior_means</span>,
                              prior_sd <span class="op">=</span> <span class="va">prior_sd</span>,
                              iter <span class="op">=</span> <span class="fl">1500</span>,
                              print_params <span class="op">=</span> <span class="cn">FALSE</span>,
                              verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">res_normal</span>
<span class="co">#&gt; Model: HMM Normal </span>
<span class="co">#&gt; Type: MCMC </span>
<span class="co">#&gt; Iter: 1500 </span>
<span class="co">#&gt; Warmup: 300 </span>
<span class="co">#&gt; Thin: 1 </span>
<span class="co">#&gt; States: 3</span>

<span class="va">summary_res_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_normal</span><span class="op">)</span>
<span class="co">#&gt; Estimated means:</span>
<span class="co">#&gt;    mean[1]    mean[2]    mean[3] </span>
<span class="co">#&gt; -4.9488931 -0.1122093  5.0463459 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimated sd:</span>
<span class="co">#&gt; 1.482213</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimated transition rates:</span>
<span class="co">#&gt;            1          2          3</span>
<span class="co">#&gt; 1 0.93750880 0.06249120 0.00000000</span>
<span class="co">#&gt; 2 0.02350138 0.95463953 0.02185909</span>
<span class="co">#&gt; 3 0.00000000 0.03754865 0.96245135</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Assigned states:</span>
<span class="co">#&gt;   1   2   3 </span>
<span class="co">#&gt; 196 524 304 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Approximate Kullback-Leibler divergence:</span>
<span class="co">#&gt; 0.004917547</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Log Likelihood:</span>
<span class="co">#&gt;         mean           sd       median </span>
<span class="co">#&gt; -2036.726273     1.838977 -2036.423079</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res_normal</span><span class="op">)</span></code></pre></div>
<p><img src="vignettesdiagnostics_normal-1.png" width="700"><img src="vignettesdiagnostics_normal-2.png" width="700"><img src="vignettesdiagnostics_normal-3.png" width="700"><img src="vignettesdiagnostics_normal-4.png" width="700"><img src="vignettesdiagnostics_normal-5.png" width="700"><img src="vignettesdiagnostics_normal-6.png" width="700"><img src="vignettesdiagnostics_normal-7.png" width="700"><img src="vignettesdiagnostics_normal-8.png" width="700"><img src="vignettesdiagnostics_normal-9.png" width="700"><img src="vignettesdiagnostics_normal-10.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lynette Caitlin Mikula, Claus Vogl, Michal Majka.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
