[{"path":"/INDEX.html","id":"id_1-overview","dir":"","previous_headings":"","what":"1. Overview","title":"Hidden Markov Models with ordered hidden states \n    and emission densities with applications in population genetics","text":"oHMMed package contains implementation Hidden Markov Models ordered hidden states emission densities. precisely: assume sequence un-observable (’hidden’) variables discrete categories known states. Moving along sequence, probability specific state occurring step depends state preceding . hidden variable along sequence produces/’emits’ observable data point. assume emitted data points distributed according continuous distribution (currently: normal gamma-poisson compound) state-specific parameters. , assume continuous emission distributions per state parametrised can ordered increasing mean. fact, transitions states hidden sequence can occur states emit densities neighbours ordering mean. Given observed data sequence, models assign part hidden sequence state, infer transition rates well parameters state-specific emission distributions. general framework oHMMed (ordered Hidden Markov Model emission densities), can applied system fulfils assumptions.","code":""},{"path":"/INDEX.html","id":"id_2-installation","dir":"","previous_headings":"","what":"2. Installation","title":"Hidden Markov Models with ordered hidden states \n    and emission densities with applications in population genetics","text":"oHMMed package currently development can installed github repository simply executing console following line:","code":"devtools::install_github(\"LynetteCaitlin/oHMMed\")"},{"path":[]},{"path":"/articles/oHMMed.html","id":"example-data","dir":"Articles","previous_headings":"Normal model","what":"Example data","title":"","text":"","code":"N <- 2^10 true_T <- rbind(c(0.95, 0.05, 0),                c(0.025, 0.95, 0.025),                c(0.0, 0.05, 0.95))  true_means <- c(-5, 0, 5) true_sd <- 1.5  simdata_full <- hmm_simulate_normal_data(L = N,                                         mat_T = true_T,                                         means = true_means,                                         sigma = true_sd) simdata <- simdata_full$data plot(density(simdata), main = \"\")"},{"path":"/articles/oHMMed.html","id":"simulation","dir":"Articles","previous_headings":"Normal model","what":"Simulation","title":"","text":"","code":"# Set priors n_states_inferred <- 3 prior_T <- generate_random_T(n_states_inferred) prior_means <- c(-7, -1, 12) prior_sd <- 3  # Run MCMC res_normal <- hmm_mcmc_normal(data = simdata,                               prior_T = prior_T,                               prior_means = prior_means,                               prior_sd = prior_sd,                               iter = 1500,                               print_params = FALSE,                               verbose = FALSE) res_normal #> Model: HMM Normal  #> Type: MCMC  #> Iter: 1500  #> Warmup: 300  #> Thin: 1  #> States: 3  summary_res_normal <- summary(res_normal) #> Estimated means: #>    mean[1]    mean[2]    mean[3]  #> -4.9488931 -0.1122093  5.0463459  #>  #> Estimated sd: #> 1.482213 #>  #> Estimated transition rates: #>            1          2          3 #> 1 0.93750880 0.06249120 0.00000000 #> 2 0.02350138 0.95463953 0.02185909 #> 3 0.00000000 0.03754865 0.96245135 #>  #> Assigned states: #>   1   2   3  #> 196 524 304  #>  #> Approximate Kullback-Leibler divergence: #> 0.004917547 #>  #> Log Likelihood: #>         mean           sd       median  #> -2036.726273     1.838977 -2036.423079"},{"path":"/articles/oHMMed.html","id":"diagnostics","dir":"Articles","previous_headings":"Normal model","what":"Diagnostics","title":"","text":"","code":"plot(res_normal)"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Lynette Caitlin Mikula. Author. Claus Vogl. Author. Michal Majka. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mikula LC, Vogl C, Majka M (2023). oHMMed: Hidden Markov Models ordered hidden states emission densities applications population genetics. https://github.com/LynetteCaitlin/oHMMed, https://lynettecaitlin.github.io/oHMMed/.","code":"@Manual{,   title = {oHMMed: Hidden Markov Models with ordered hidden states and emission densities with applications in population genetics},   author = {Lynette Caitlin Mikula and Claus Vogl and Michal Majka},   year = {2023},   note = {https://github.com/LynetteCaitlin/oHMMed, https://lynettecaitlin.github.io/oHMMed/}, }"},{"path":"/reference/coef.hmm_mcmc_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract model estimates — coef.hmm_mcmc_normal","title":"Extract model estimates — coef.hmm_mcmc_normal","text":"coef generic function extracts model estimates mcmc_hmm_* objects","code":""},{"path":"/reference/coef.hmm_mcmc_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract model estimates — coef.hmm_mcmc_normal","text":"","code":"# S3 method for hmm_mcmc_normal coef(object, ...)  # S3 method for hmm_mcmc_poisson coef(object, ...)"},{"path":"/reference/coef.hmm_mcmc_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract model estimates — coef.hmm_mcmc_normal","text":"object object class inheriting \"mcmc_hmm_*\" ... used","code":""},{"path":"/reference/coef.hmm_mcmc_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract model estimates — coef.hmm_mcmc_normal","text":"Estimates extracted MCMC HMM objects","code":""},{"path":"/reference/coef.hmm_mcmc_normal.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Extract model estimates — coef.hmm_mcmc_normal","text":"coef(hmm_mcmc_poisson):","code":""},{"path":"/reference/coef.hmm_mcmc_normal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract model estimates — coef.hmm_mcmc_normal","text":"","code":"# TODO # TODO"},{"path":"/reference/conf_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a confusion matrix...DESCRIPTION TO BE IMPROVED — conf_mat","title":"Calculate a confusion matrix...DESCRIPTION TO BE IMPROVED — conf_mat","text":"diagnostic function tests reliability estimation procedures given inferred transition rates","code":""},{"path":"/reference/conf_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a confusion matrix...DESCRIPTION TO BE IMPROVED — conf_mat","text":"","code":"conf_mat(N, res, plot = TRUE)"},{"path":"/reference/conf_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a confusion matrix...DESCRIPTION TO BE IMPROVED — conf_mat","text":"N (numeric) number simulations res (mcmc_hmm_\\*) simulated MCMC HMM model plot (logical) plot confusion matrix. default TRUE","code":""},{"path":"/reference/conf_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a confusion matrix...DESCRIPTION TO BE IMPROVED — conf_mat","text":"Confusion matrix: confusion_matrix","code":""},{"path":"/reference/conf_mat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate a confusion matrix...DESCRIPTION TO BE IMPROVED — conf_mat","text":"First data simulated given inferred model parameters transition rates. posterior probabilities calculated states inferred. Finally, inferred states simulated states compared via confusion_matrix function.","code":""},{"path":"/reference/conf_mat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate a confusion matrix...DESCRIPTION TO BE IMPROVED — conf_mat","text":"","code":"# TODO"},{"path":"/reference/convert_to_ggmcmc.html","id":null,"dir":"Reference","previous_headings":"","what":"Converts MCMC samples into ggmcmc format — convert_to_ggmcmc","title":"Converts MCMC samples into ggmcmc format — convert_to_ggmcmc","text":"helper function converts MCMC samples ggmcmc format","code":""},{"path":"/reference/convert_to_ggmcmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Converts MCMC samples into ggmcmc format — convert_to_ggmcmc","text":"","code":"convert_to_ggmcmc(   x,   pattern = c(\"mean\", \"sigma\", \"beta\", \"alpha\", \"pois_means\", \"T\"),   include_warmup = FALSE )"},{"path":"/reference/convert_to_ggmcmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Converts MCMC samples into ggmcmc format — convert_to_ggmcmc","text":"x (mcmc_hmm_*) MCMC HMM object pattern (character) pattern(s) model parameters included output include_warmup (logical) include warmup samples. default FALSE","code":""},{"path":"/reference/convert_to_ggmcmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Converts MCMC samples into ggmcmc format — convert_to_ggmcmc","text":"data.frame compatible functions ggmcmc package","code":""},{"path":"/reference/convert_to_ggmcmc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Converts MCMC samples into ggmcmc format — convert_to_ggmcmc","text":"","code":"# TODO"},{"path":"/reference/eigen_system.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate eigenvalues and eigenvectors. — eigen_system","title":"Calculate eigenvalues and eigenvectors. — eigen_system","text":"helper function returns eigenvalues lambda left right eigenvectors forwards backwards.","code":""},{"path":"/reference/eigen_system.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate eigenvalues and eigenvectors. — eigen_system","text":"","code":"eigen_system(mat)"},{"path":"/reference/eigen_system.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate eigenvalues and eigenvectors. — eigen_system","text":"mat (matrix) square matrix","code":""},{"path":"/reference/eigen_system.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate eigenvalues and eigenvectors. — eigen_system","text":"list three elements: lambda: eigenvalues forwards: left eigenvector backwards: right eigenvector","code":""},{"path":"/reference/eigen_system.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate eigenvalues and eigenvectors. — eigen_system","text":"","code":"mat_T0 <- rbind(c(1-0.01,0.01,0),                c(0.01,1-0.02,0.01),                c(0,0.01,1-0.01)) eigen_system(mat_T0) #> $lambda #> [1] 1.00 0.99 0.97 #>  #> $forwards #>            [,1]          [,2]      [,3] #> [1,]  0.3333333  3.333333e-01 0.3333333 #> [2,] -0.3333333 -2.631640e-16 0.3333333 #> [3,]  0.2222222 -4.444444e-01 0.2222222 #>  #> $backwards #>      [,1]          [,2]  [,3] #> [1,]    1 -1.500000e+00  0.75 #> [2,]    1 -1.040834e-15 -1.50 #> [3,]    1  1.500000e+00  0.75 #>"},{"path":"/reference/generate_random_T.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a random transition matrix — generate_random_T","title":"Generate a random transition matrix — generate_random_T","text":"helper function generates transition matrix random testing purposes","code":""},{"path":"/reference/generate_random_T.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a random transition matrix — generate_random_T","text":"","code":"generate_random_T(n = 3)"},{"path":"/reference/generate_random_T.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a random transition matrix — generate_random_T","text":"n (integer) dimension transition matrix","code":""},{"path":"/reference/generate_random_T.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a random transition matrix — generate_random_T","text":"random n x n transition matrix","code":""},{"path":"/reference/generate_random_T.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate a random transition matrix — generate_random_T","text":"Uniform random numbers \\([0,1]\\) used fill matrix. Rows normalized.","code":""},{"path":"/reference/generate_random_T.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a random transition matrix — generate_random_T","text":"","code":"mat_T <- generate_random_T(3) mat_T #>           [,1]       [,2]      [,3] #> [1,] 0.9613519 0.03864807 0.0000000 #> [2,] 0.5682587 0.05613195 0.3756094 #> [3,] 0.0000000 0.56083176 0.4391682 rowSums(mat_T) #> [1] 1 1 1"},{"path":"/reference/get_pi.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the prior probability of states — get_pi","title":"Get the prior probability of states — get_pi","text":"Calculate prior probability states correspond stationary distribution transition matrix T","code":""},{"path":"/reference/get_pi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the prior probability of states — get_pi","text":"","code":"get_pi(mat_T = NULL)"},{"path":"/reference/get_pi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the prior probability of states — get_pi","text":"mat_T (matrix) transition matrix","code":""},{"path":"/reference/get_pi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the prior probability of states — get_pi","text":"numeric vector","code":""},{"path":"/reference/get_pi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get the prior probability of states — get_pi","text":"assumed prior probability states corresponds stationary distribution transition matrix \\(T\\), denoted \\(\\pi\\) entries \\(\\pi_i=Pr(\\theta_{l-1}=)\\).","code":""},{"path":"/reference/get_pi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the prior probability of states — get_pi","text":"","code":"T_mat <- rbind(c(1-0.01,0.01,0),                c(0.01,1-0.02,0.01),                c(0,0.01,1-0.01)) T_mat #>      [,1] [,2] [,3] #> [1,] 0.99 0.01 0.00 #> [2,] 0.01 0.98 0.01 #> [3,] 0.00 0.01 0.99 get_pi(T_mat) #> [1] 0.3333333 0.3333333 0.3333333"},{"path":"/reference/hmm_mcmc_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"MCMC simulation of a Hidden Markov Normal Model — hmm_mcmc_normal","title":"MCMC simulation of a Hidden Markov Normal Model — hmm_mcmc_normal","text":"MCMC simulation Hidden Markov Normal Model","code":""},{"path":"/reference/hmm_mcmc_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MCMC simulation of a Hidden Markov Normal Model — hmm_mcmc_normal","text":"","code":"hmm_mcmc_normal(   data,   prior_T,   prior_means,   prior_sd,   iter = 600,   warmup = floor(iter/5),   thin = 1,   seed = sample.int(.Machine$integer.max, 1),   init_T = NULL,   init_means = NULL,   init_sd = NULL,   print_params = TRUE,   verbose = TRUE )"},{"path":"/reference/hmm_mcmc_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MCMC simulation of a Hidden Markov Normal Model — hmm_mcmc_normal","text":"data (numeric) normal data prior_T (matrix) prior transition matrix prior_means (numeric) prior means prior_sd (numeric) single prior standard devation iter (integer) number MCMC iterations warmup (integer) number warmup iterations thin (integer) thinning parameter. default, 1 seed (integer) seed parameter init_T (matrix) optional parameter; initial transition matrix init_means (numeric) optional parameter; initial means init_sd (numeric) optional parameter; initial standard deviation print_params (logical) optional parameter; print parameters every iteration. default, TRUE verbose (logical) optional parameter; print additional messages. default, TRUE","code":""},{"path":"/reference/hmm_mcmc_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MCMC simulation of a Hidden Markov Normal Model — hmm_mcmc_normal","text":"List following elements: data: data used simulation estimates: list various estimates idx: indices iterations warmup period priors: prior parameters inits: initial parameters last_iter: list samples last MCMC iteration info: list various meta information object","code":""},{"path":"/reference/hmm_mcmc_normal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"MCMC simulation of a Hidden Markov Normal Model — hmm_mcmc_normal","text":"details","code":""},{"path":"/reference/hmm_mcmc_normal.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"MCMC simulation of a Hidden Markov Normal Model — hmm_mcmc_normal","text":"references","code":""},{"path":"/reference/hmm_mcmc_normal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MCMC simulation of a Hidden Markov Normal Model — hmm_mcmc_normal","text":"","code":"# Simulate normal data N <- 2^10 true_T <- rbind(c(0.95, 0.05, 0),                 c(0.025, 0.95, 0.025),                 c(0.0, 0.05, 0.95))  true_means <- c(-5, 0, 5) true_sd <- 1.5  simdata_full <- hmm_simulate_normal_data(L = N,                                           mat_T = true_T,                                           means = true_means,                                          sigma = true_sd) simdata <- simdata_full$data hist(simdata, breaks = 40, probability = TRUE,        main = \"Distribution of the simulated normal data\") lines(density(simdata), col = \"red\")   # Set numbers of states to be inferred n_states_inferred <- 3  # Set priors prior_T <- generate_random_T(n_states_inferred) prior_means <- c(-18, -1, 12) prior_sd <- 3  # Simmulation settings iter <- 50 warmup <- floor(iter / 5) # 20 percent thin <- 1 seed <- sample.int(10000, 1) print_params <- FALSE # if TRUE then parameters are printed in each iteration verbose <- FALSE # if TRUE then the state of the simulation is printed  # Run MCMC sampler res <- hmm_mcmc_normal(data = simdata,                        prior_T = prior_T,                        prior_means = prior_means,                        prior_sd = prior_sd,                        iter = iter,                        warmup = warmup,                        seed = seed,                        print_params = print_params,                        verbose = verbose) res #> Model: HMM Normal  #> Type: MCMC  #> Iter: 50  #> Warmup: 10  #> Thin: 1  #> States: 3   summary(res) # summary output can be also assigned to a variable #> Estimated means: #>   mean[1]   mean[2]   mean[3]  #> -1.869496 -1.672465  4.585370  #>  #> Estimated sd: #> 2.617734 #>  #> Estimated transition rates: #>              1          2          3 #> 1 4.240528e-05 0.99995759 0.00000000 #> 2 7.445623e-01 0.22900741 0.02643029 #> 3 0.000000e+00 0.04697765 0.95302235 #>  #> Assigned states: #>   1   2   3  #>  97 674 253  #>  #> Approximate Kullback-Leibler divergence: #> 0.006925627 #>  #> Log Likelihood: #>        mean          sd      median  #> -2499.71769     1.83077 -2499.21185  #>   coef(res) # extract model estimates #> $means #>   mean[1]   mean[2]   mean[3]  #> -1.869496 -1.672465  4.585370  #>  #> $sd #> [1] 2.617734 #>  #> $mat_T #>              [,1]       [,2]       [,3] #> [1,] 4.240528e-05 0.99995759 0.00000000 #> [2,] 7.445623e-01 0.22900741 0.02643029 #> [3,] 0.000000e+00 0.04697765 0.95302235 #>   # plot(res) # MCMC diagnostics"},{"path":"/reference/hmm_mcmc_pois.html","id":null,"dir":"Reference","previous_headings":"","what":"MCMC simulation of a Hidden Markov Normal Model for Poisson model — hmm_mcmc_pois","title":"MCMC simulation of a Hidden Markov Normal Model for Poisson model — hmm_mcmc_pois","text":"MCMC simulation Hidden Markov Normal Model Poisson model","code":""},{"path":"/reference/hmm_mcmc_pois.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MCMC simulation of a Hidden Markov Normal Model for Poisson model — hmm_mcmc_pois","text":"","code":"hmm_mcmc_pois(   data,   prior_T,   prior_betas,   prior_alpha = 1,   iter = 1500,   warmup = floor(iter/1.5),   thin = 1,   seed = sample.int(.Machine$integer.max, 1),   init_T = NULL,   init_betas = NULL,   init_alpha = NULL,   print_params = TRUE,   verbose = TRUE )"},{"path":"/reference/hmm_mcmc_pois.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MCMC simulation of a Hidden Markov Normal Model for Poisson model — hmm_mcmc_pois","text":"data (numeric) data prior_T (matrix) prior transition matrix prior_betas (numeric) prior beta parameters prior_alpha (numeric) single prior alpha parameter. default, prior_alpha=1 iter (integer) number MCMC iterations warmup (integer) number warmup iterations thin (integer) thinning parameter. default, 1 seed (integer) seed parameter init_T (matrix) optional parameter; initial transition matrix init_betas (numeric) optional parameter; initial beta parameters init_alpha (numeric) optional parameter; initial alpha parameter print_params (logical) optional parameter; print estimated parameters every iteration. default, TRUE verbose (logical) optional parameter; print additional messages. default, TRUE","code":""},{"path":"/reference/hmm_mcmc_pois.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MCMC simulation of a Hidden Markov Normal Model for Poisson model — hmm_mcmc_pois","text":"List following elements: data: data used simulation estimates: list various estimates idx: indices iterations warmup period priors: prior parameters inits: initial parameters last_iter: list samples last MCMC iteration info: list various meta information object","code":""},{"path":"/reference/hmm_mcmc_pois.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"MCMC simulation of a Hidden Markov Normal Model for Poisson model — hmm_mcmc_pois","text":"details","code":""},{"path":"/reference/hmm_mcmc_pois.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"MCMC simulation of a Hidden Markov Normal Model for Poisson model — hmm_mcmc_pois","text":"references","code":""},{"path":"/reference/hmm_mcmc_pois.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MCMC simulation of a Hidden Markov Normal Model for Poisson model — hmm_mcmc_pois","text":"","code":"# Simulate Poisson-Gamma data N <- 2^10 true_T <- rbind(c(0.95, 0.05, 0),                 c(0.025, 0.95, 0.025),                 c(0.0, 0.05, 0.95))  true_betas <- c(2, 1, 0.1) true_alpha <- 1  simdata_full <- hmm_simulate_poisgamma_data(L = N,                                             mat_T = true_T,                                             betas = true_betas,                                             alpha = true_alpha) simdata <- simdata_full$data hist(simdata, breaks = 40, probability = TRUE,        main = \"Distribution of the simulated Poisson-Gamma data\") lines(density(simdata), col = \"red\")   # Set numbers of states to be inferred n_states_inferred <- 3  # Set priors prior_T <- generate_random_T(n_states_inferred) prior_betas <- c(1, 0.5, 0.1) prior_alpha <- 3  # Simmulation settings iter <- 50 warmup <- floor(iter / 5) # 20 percent thin <- 1 seed <- sample.int(10000, 1) print_params <- FALSE # if TRUE then parameters are printed in each iteration verbose <- FALSE # if TRUE then the state of the simulation is printed  # Run MCMC sampler res <- hmm_mcmc_pois(data = simdata,                      prior_T = prior_T,                      prior_betas = prior_betas,                      prior_alpha = prior_alpha,                      iter = iter,                      warmup = warmup,                        thin = thin,                      seed = seed,                      print_params = print_params,                      verbose = verbose) res #> Model: HMM Poisson  #> Type: MCMC  #> Iter: 50  #> Warmup: 10  #> Thin: 1  #> States: 3   summary(res)# summary output can be also assigned to a variable #> Estimated betas: #>   beta[1]   beta[2]   beta[3]  #> 7.3980479 1.6046574 0.2895165  #>  #> Estimated alpha: #> 5.790816 #>  #> Estimated means: #> 0.7925002 3.698456 20.0825 #>  #> Estimated transition rates: #>           1          2         3 #> 1 0.9601504 0.03984961 0.0000000 #> 2 0.1306367 0.44755159 0.4218117 #> 3 0.0000000 0.54026032 0.4597397 #>  #> Assigned states: #>   1   2   3  #> 681 191 152  #>  #> Approximate Kullback-Leibler divergence: #> 0.2898982 #>  #> Log Likelihood: #>        mean          sd      median  #> -2178.62149    16.75306 -2171.46498  #>  #> Significance of Difference between Rates (stepwise): #> [1] 1.529215e-151  0.000000e+00 #>   coef(res) # extract model estimates #> $betas #>   beta[1]   beta[2]   beta[3]  #> 7.3980479 1.6046574 0.2895165  #>  #> $alpha #> [1] 5.790816 #>  #> $means #>   means[1]   means[2]   means[3]  #>  0.7925002  3.6984563 20.0825040  #>  #> $mat_T #>           [,1]       [,2]      [,3] #> [1,] 0.9601504 0.03984961 0.0000000 #> [2,] 0.1306367 0.44755159 0.4218117 #> [3,] 0.0000000 0.54026032 0.4597397 #>   # plot(res) # MCMC diagnostics"},{"path":"/reference/hmm_simulate_normal_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Hidden Markov Model simulation with normal data. — hmm_simulate_normal_data","title":"Hidden Markov Model simulation with normal data. — hmm_simulate_normal_data","text":"Simulate Hidden Markov Model based normal data.","code":""},{"path":"/reference/hmm_simulate_normal_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hidden Markov Model simulation with normal data. — hmm_simulate_normal_data","text":"","code":"hmm_simulate_normal_data(L, mat_T, means, sigma)"},{"path":"/reference/hmm_simulate_normal_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hidden Markov Model simulation with normal data. — hmm_simulate_normal_data","text":"L (integer) number simulations mat_T (matrix) square matrix initial state means (numeric) mean parameter rnorm emission probabilities sigma (numeric) sd parameter rnorm emission probabilities","code":""},{"path":"/reference/hmm_simulate_normal_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hidden Markov Model simulation with normal data. — hmm_simulate_normal_data","text":"returns data vector \"data\", \"true\" hidden states \"states\" used generate data vector prior probability states \"pi\".","code":""},{"path":"/reference/hmm_simulate_normal_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hidden Markov Model simulation with normal data. — hmm_simulate_normal_data","text":"","code":"mat_T0 <- rbind(c(1-0.01,0.01,0),                c(0.01,1-0.02,0.01),                c(0,0.01,1-0.01)) L <- 2^5 means0 <- c(-1,0,1) sigma0 <- 1  sim_data <- hmm_simulate_normal_data(L = L, mat_T = mat_T0, means = means0, sigma = sigma0) plot(density(sim_data$data), main = \"Density\")  sim_data #> $data #>  [1] -0.19867212 -1.14693461  2.04385999  0.90220784  0.25350486 -2.27197586 #>  [7]  0.26239220  1.48969111 -0.11641747 -1.15071197  0.91623005  1.23593646 #> [13] -0.30940136  0.61970147 -0.67694493  1.27942428  0.60047957 -0.57800587 #> [19]  0.90726235 -0.05539879  0.22352093  1.23564724 -0.02683020  0.02734803 #> [25] -0.33522226  0.96352352 -2.14590267  1.13489390  1.79139051 -0.65236977 #> [31] -1.03944441  0.75866192 #>  #> $states #>  [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 #> Levels: 1 2 3 #>  #> $pi #> [1] 0.3333333 0.3333333 0.3333333 #>"},{"path":"/reference/hmm_simulate_poisgamma_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a Hidden Markov Model based on Poisson-gamma data — hmm_simulate_poisgamma_data","title":"Simulate a Hidden Markov Model based on Poisson-gamma data — hmm_simulate_poisgamma_data","text":"Simulate Hidden Markov Model based Poisson-gamma data","code":""},{"path":"/reference/hmm_simulate_poisgamma_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a Hidden Markov Model based on Poisson-gamma data — hmm_simulate_poisgamma_data","text":"","code":"hmm_simulate_poisgamma_data(L, mat_T, betas, alpha)"},{"path":"/reference/hmm_simulate_poisgamma_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a Hidden Markov Model based on Poisson-gamma data — hmm_simulate_poisgamma_data","text":"L (integer) number simulations mat_T (matrix) square matrix initial state betas (numeric) rate parameter rgamma emission probabilities alpha (numeric) shape parameter rgamma emission probabilities","code":""},{"path":"/reference/hmm_simulate_poisgamma_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a Hidden Markov Model based on Poisson-gamma data — hmm_simulate_poisgamma_data","text":"returns data vector \"data\", \"true\" hidden states \"states\" used generate data vector prior probability states \"pi\".","code":""},{"path":"/reference/hmm_simulate_poisgamma_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a Hidden Markov Model based on Poisson-gamma data — hmm_simulate_poisgamma_data","text":"","code":"mat_T <- rbind(c(1-0.01,0.01,0),                c(0.01,1-0.02,0.01),                c(0,0.01,1-0.01)) L <- 2^10 betas <- c(0.1, 0.3, 0.5) alpha <- 1  sim_data <- hmm_simulate_poisgamma_data(L = L,                                         mat_T = mat_T,                                         betas = betas,                                         alpha = alpha) hist(sim_data$data, breaks = 100, main = \"Histogram\")"},{"path":"/reference/kullback_leibler_cont_appr.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a continuous approximation of the Kullback-Leibler divergence — kullback_leibler_cont_appr","title":"Calculate a continuous approximation of the Kullback-Leibler divergence — kullback_leibler_cont_appr","text":"Calculate continuous approximation Kullback-Leibler divergence","code":""},{"path":"/reference/kullback_leibler_cont_appr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a continuous approximation of the Kullback-Leibler divergence — kullback_leibler_cont_appr","text":"","code":"kullback_leibler_cont_appr(p, q)"},{"path":"/reference/kullback_leibler_cont_appr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a continuous approximation of the Kullback-Leibler divergence — kullback_leibler_cont_appr","text":"p (numeric) probabilities q (numeric) probabilities","code":""},{"path":"/reference/kullback_leibler_cont_appr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a continuous approximation of the Kullback-Leibler divergence — kullback_leibler_cont_appr","text":"Numeric vector","code":""},{"path":"/reference/kullback_leibler_cont_appr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate a continuous approximation of the Kullback-Leibler divergence — kullback_leibler_cont_appr","text":"continuous approximation Kullback-Leibler divergence calculated follows: $$   \\frac{1}{n}\\sum_{=1}^n\\big[\\log(p_i) p_i - log(q_i) p_i \\big] $$","code":""},{"path":"/reference/kullback_leibler_cont_appr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate a continuous approximation of the Kullback-Leibler divergence — kullback_leibler_cont_appr","text":"","code":"# Simulate n normally distributed variates n <- 1000 dist1 <- rnorm(n) dist2 <- rnorm(n, mean = 0, sd = 2) dist3 <- rnorm(n, mean = 2, sd = 2)  # Estimate probability density functions pdf1 <- density(dist1) pdf2 <- density(dist2) pdf3 <- density(dist3)  # Visualise PDFs plot(pdf1, main = \"PDFs\", col = \"red\", xlim = range(dist3)) lines(pdf2, col = \"blue\") lines(pdf3, col = \"green\")   # PDF 1 vs PDF 2 kullback_leibler_cont_appr(pdf1$y, pdf2$y) #> [1] 0.1177408  # PDF 1 vs PDF 3 kullback_leibler_cont_appr(pdf1$y, pdf3$y) #> [1] 0.1477133  # PDF 2 vs PDF 2 kullback_leibler_cont_appr(pdf2$y, pdf3$y) #> [1] 0.006016054"},{"path":"/reference/kullback_leibler_disc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a Kullback-Leibler divergence for a discrete distribution — kullback_leibler_disc","title":"Calculate a Kullback-Leibler divergence for a discrete distribution — kullback_leibler_disc","text":"Calculate Kullback-Leibler divergence discrete distribution","code":""},{"path":"/reference/kullback_leibler_disc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a Kullback-Leibler divergence for a discrete distribution — kullback_leibler_disc","text":"","code":"kullback_leibler_disc(p, q)"},{"path":"/reference/kullback_leibler_disc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a Kullback-Leibler divergence for a discrete distribution — kullback_leibler_disc","text":"p (numeric) probabilities q (numeric) probabilities","code":""},{"path":"/reference/kullback_leibler_disc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a Kullback-Leibler divergence for a discrete distribution — kullback_leibler_disc","text":"Numeric vector","code":""},{"path":"/reference/kullback_leibler_disc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate a Kullback-Leibler divergence for a discrete distribution — kullback_leibler_disc","text":"Kullback-Leibler divergence discrete distribution calculated follows: $$\\sum_{=1}^n p_i \\log\\Big(\\frac{p_i}{q_i}\\Big)$$","code":""},{"path":"/reference/kullback_leibler_disc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate a Kullback-Leibler divergence for a discrete distribution — kullback_leibler_disc","text":"","code":"# Simulate n Poisson distributed variates n <- 1000 dist1 <- rpois(n, lambda = 1) dist2 <- rpois(n, lambda = 5) dist3 <- rpois(n, lambda = 20)  # Generate common factor levels x_max <- max(c(dist1, dist2, dist3)) all_levels <- 0:x_max  # Estimate probability mass functions  pmf_dist1 <- table(factor(dist1, levels = all_levels)) / n pmf_dist2 <- table(factor(dist2, levels = all_levels)) / n pmf_dist3 <- table(factor(dist3, levels = all_levels)) / n  # Visualise PMFs barplot(pmf_dist1, col = \"green\", xlim = c(0, x_max)) barplot(pmf_dist2, col = \"red\", add = TRUE) barplot(pmf_dist3, col = \"blue\", add = TRUE)   # Calculate distances kullback_leibler_disc(pmf_dist1, pmf_dist2) #> [1] 2.429008 kullback_leibler_disc(pmf_dist1, pmf_dist3) #> [1] 26.33711 kullback_leibler_disc(pmf_dist2, pmf_dist3) #> [1] 23.94782"},{"path":"/reference/plot.hmm_mcmc_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot method for hmm_mcmc_normal objects — plot.hmm_mcmc_normal","title":"Plot method for hmm_mcmc_normal objects — plot.hmm_mcmc_normal","text":"Plot method hmm_mcmc_normal objects","code":""},{"path":"/reference/plot.hmm_mcmc_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot method for hmm_mcmc_normal objects — plot.hmm_mcmc_normal","text":"","code":"# S3 method for hmm_mcmc_normal plot(   x,   simulation = FALSE,   true_means = NULL,   true_sd = NULL,   true_mat_T = NULL,   true_states = NULL,   ... )"},{"path":"/reference/plot.hmm_mcmc_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot method for hmm_mcmc_normal objects — plot.hmm_mcmc_normal","text":"x (hmm_mcmc_\\*) MCMC HMM object simulation (logical) true_means (numeric) true_sd (numeric) true_mat_T (matrix) true_states (integer) ... used","code":""},{"path":"/reference/plot.hmm_mcmc_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot method for hmm_mcmc_normal objects — plot.hmm_mcmc_normal","text":"return value","code":""},{"path":"/reference/plot.hmm_mcmc_normal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot method for hmm_mcmc_normal objects — plot.hmm_mcmc_normal","text":"details","code":""},{"path":"/reference/plot.hmm_mcmc_normal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot method for hmm_mcmc_normal objects — plot.hmm_mcmc_normal","text":"","code":"# TODO"},{"path":"/reference/plot.hmm_mcmc_poisson.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot method for hmm_mcmc_poisson objects — plot.hmm_mcmc_poisson","title":"Plot method for hmm_mcmc_poisson objects — plot.hmm_mcmc_poisson","text":"Plot method hmm_mcmc_poisson objects","code":""},{"path":"/reference/plot.hmm_mcmc_poisson.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot method for hmm_mcmc_poisson objects — plot.hmm_mcmc_poisson","text":"","code":"# S3 method for hmm_mcmc_poisson plot(   x,   simulation = FALSE,   true_betas = NULL,   true_alpha = NULL,   true_mat_T = NULL,   true_states = NULL,   ... )"},{"path":"/reference/plot.hmm_mcmc_poisson.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot method for hmm_mcmc_poisson objects — plot.hmm_mcmc_poisson","text":"x (hmm_mcmc_\\*) MCMC HMM object simulation (logical) true_betas (numeric) true_alpha (numeric) true_mat_T (matrix) true_states (integer) ... used","code":""},{"path":"/reference/plot.hmm_mcmc_poisson.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot method for hmm_mcmc_poisson objects — plot.hmm_mcmc_poisson","text":"return value","code":""},{"path":"/reference/plot.hmm_mcmc_poisson.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot method for hmm_mcmc_poisson objects — plot.hmm_mcmc_poisson","text":"details","code":""},{"path":"/reference/plot.hmm_mcmc_poisson.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot method for hmm_mcmc_poisson objects — plot.hmm_mcmc_poisson","text":"","code":"# TODO"},{"path":"/reference/posterior_probabilities_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Forward-backward algorithm to calculate the posterior probabilities of hidden states. — posterior_probabilities_normal","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states. — posterior_probabilities_normal","text":"Forward-backward algorithm calculate posterior probabilities hidden states.","code":""},{"path":"/reference/posterior_probabilities_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states. — posterior_probabilities_normal","text":"","code":"posterior_probabilities_normal(data, pi, mat_T, means, sdev)"},{"path":"/reference/posterior_probabilities_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states. — posterior_probabilities_normal","text":"data (numeric) normal data pi (numeric) prior probability states mat_T (matrix) transition probability matrix means (numeric) vector prior means sdev (numeric) prior standard deviation","code":""},{"path":"/reference/posterior_probabilities_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states. — posterior_probabilities_normal","text":"List posterior probabilities (CORRECTED)","code":""},{"path":"/reference/posterior_probabilities_normal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states. — posterior_probabilities_normal","text":"details calculation made","code":""},{"path":"/reference/posterior_probabilities_normal.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states. — posterior_probabilities_normal","text":"references","code":""},{"path":"/reference/posterior_probabilities_normal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states. — posterior_probabilities_normal","text":"","code":"prior_mat <- rbind(c(1-0.05, 0.05, 0),                   c(0.05, 1-0.1, 0.05),                   c(0, 0.05, 1-0.05))  prior_means <- c(-0.1, 0.0, 0.1) prior_sd  <- sqrt(0.1) L <- 100  # Simulate HMM model based on normal data based on prior information sim_data_normal <- hmm_simulate_normal_data(L = L,                                             mat_T = prior_mat,                                             means = prior_means,                                             sigma = prior_sd) pi <- sim_data_normal$pi # pi <- get_pi(prior_mat) hmm_norm_data <- sim_data_normal$data  # Calculate posterior probabilities of hidden states post_prob <-  posterior_probabilities_normal(data = hmm_norm_data,                                              pi = pi,                                              mat_T = prior_mat,                                              means = prior_means,                                              sdev = prior_sd)"},{"path":"/reference/posterior_probabilities_poisgamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Forward-backward algorithm to calculate the posterior probabilities of hidden states in Poisson-Gamma model. — posterior_probabilities_poisgamma","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states in Poisson-Gamma model. — posterior_probabilities_poisgamma","text":"Forward-backward algorithm calculate posterior probabilities hidden states Poisson-Gamma model.","code":""},{"path":"/reference/posterior_probabilities_poisgamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states in Poisson-Gamma model. — posterior_probabilities_poisgamma","text":"","code":"posterior_probabilities_poisgamma(data, pi, mat_T, betas, alpha)"},{"path":"/reference/posterior_probabilities_poisgamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states in Poisson-Gamma model. — posterior_probabilities_poisgamma","text":"data (numeric) Poisson data pi (numeric) prior probability states mat_T (matrix) transition probability matrix betas (numeric) vector prior rates alpha (numeric) prior scale","code":""},{"path":"/reference/posterior_probabilities_poisgamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states in Poisson-Gamma model. — posterior_probabilities_poisgamma","text":"List posterior probabilities (CORRECTED)","code":""},{"path":"/reference/posterior_probabilities_poisgamma.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states in Poisson-Gamma model. — posterior_probabilities_poisgamma","text":"details calculation made","code":""},{"path":"/reference/posterior_probabilities_poisgamma.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states in Poisson-Gamma model. — posterior_probabilities_poisgamma","text":"references","code":""},{"path":"/reference/posterior_probabilities_poisgamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Forward-backward algorithm to calculate the posterior probabilities of hidden states in Poisson-Gamma model. — posterior_probabilities_poisgamma","text":"","code":"mat_T <- rbind(c(1-0.01,0.01,0),                c(0.01,1-0.02,0.01),                c(0,0.01,1-0.01)) L <- 2^10 betas <- c(0.1, 0.3, 0.5) alpha <- 1  sim_data <- hmm_simulate_poisgamma_data(L = L,                                         mat_T = mat_T,                                         betas = betas,                                         alpha = alpha) pi <- sim_data$pi hmm_poison_data <- sim_data$data hist(hmm_poison_data, breaks = 100)   # Calculate posterior probabilities of hidden states post_prob <-  posterior_probabilities_poisgamma(data = hmm_poison_data,                                                 pi = pi,                                                 mat_T = mat_T,                                                 betas = betas,                                                 alpha = alpha)"},{"path":"/news/index.html","id":"ohmmed-090","dir":"Changelog","previous_headings":"","what":"oHMMED 0.9.0","title":"oHMMED 0.9.0","text":"Initial release","code":""}]
